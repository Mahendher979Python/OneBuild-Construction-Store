<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Order Placed — OneBuild</title>
  <link rel="stylesheet" href="/css/cart.css">
  <style>.summary-box{padding:16px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border:1px solid rgba(255,255,255,0.03)}</style>
</head>
<body>
<header class="header container">
  <div class="brand">
    <img src="/images/homepages/onebuild.png" alt="brand">
    <div><div class="subtitle">Order Success</div></div>
  </div>

  <div class="nav">
    <a href="/templates/index.html">Home</a>
    <a href="/templates/cartpayment/cart.html">Cart</a>
    <a href="/templates/orders/track.html">Track Order</a>
    <button class="cart-btn" onclick="location.href='/templates/cartpayment/cart.html'">Cart <span id="cart-badge">0</span></button>
  </div>
</header>

<main class="container">
  <h1 class="page-title">Thank you — Order Placed!</h1>

  <div class="summary-box">
    <h3 id="thankTitle">Order received</h3>
    <p id="thanksSub" class="small-muted">We've received your order. You'll get updates on your phone & email.</p>

    <div style="margin-top:10px">
      <strong>Order ID:</strong> <span id="orderId"></span>
    </div>

    <div id="orderSummary" style="margin-top:12px"></div>

    <div style="margin-top:14px">
      <button class="btn" onclick="window.location='/templates/orders/track.html'">Track Order</button>
      <button class="btn" onclick="window.location='/templates/index.html'">Back to Home</button>
    </div>
  </div>

  <section style="margin-top:20px">
    <h4>Delivery & Support</h4>
    <p class="small-muted">For support, contact <a href="mailto:support@onebuild.example">support@onebuild.example</a> or call 1800-XXX-XXXX</p>
  </section>
</main>

<script src="/javascript/cart.js"></script>
<script>
  function getQueryParam(name){
    const params = new URLSearchParams(window.location.search);
    return params.get(name);
  }

  document.addEventListener('DOMContentLoaded', function(){
    const orderId = getQueryParam('order') || localStorage.getItem('last_order_id') || '';
    document.getElementById('orderId').innerText = orderId || '—';

    // try to find order in orders array
    const orders = JSON.parse(localStorage.getItem('orders') || '[]');
    const order = orders.find(o=>o.orderId === orderId) || null;

    const summaryBox = document.getElementById('orderSummary');
    if(order){
      // show customer + items summary
      summaryBox.innerHTML = `
        <div><strong>Name:</strong> ${order.customer.name}</div>
        <div><strong>Phone:</strong> ${order.customer.phone}</div>
        <div style="margin-top:8px"><strong>Items:</strong></div>
        <ul>${order.items.map(i=>`<li>${i.name} × ${i.qty} — ₹${(i.price*i.qty).toLocaleString()}</li>`).join('')}</ul>
        <div style="margin-top:6px"><strong>Total:</strong> ₹${order.totals.grand.toLocaleString()}</div>
        <div style="margin-top:6px"><strong>Payment:</strong> ${order.payment.method}</div>
        <div style="margin-top:10px"><strong>Status:</strong> ${order.status}</div>
      `;
      // show tracking steps (static simulation)
      summaryBox.innerHTML += `
        <div style="margin-top:12px">
          <h4>Tracking</h4>
          <ol>
            <li>Order placed — ${new Date(order.createdAt).toLocaleString()}</li>
            <li>Processing — within 24 hours</li>
            <li>Dispatched — estimated in 1-3 business days</li>
            <li>Out for delivery — on delivery day</li>
          </ol>
        </div>
      `;
    } else {
      summaryBox.innerHTML = `<div class="small-muted">Order details not found in local storage. If you used another device, tracking will be available via our backend (when integrated).</div>`;
    }

    updateCartBadge();
  });
</script>
</body>
</html>
